##############################################################################
# Copyright (c) 2018 Mirantis Inc. and others.
# All rights reserved. This program and the accompanying materials
# are made available under the terms of the Apache License, Version 2.0
# which accompanies this distribution, and is available at
# http://www.apache.org/licenses/LICENSE-2.0
##############################################################################
---
applications:
  - opendaylight
classes:
  - service.keepalived.cluster.single
parameters:
  _param:
    opendaylight_version: fluorine
    keepalived_vip_virtual_router_id: 199
    keepalived_vip_address: ${_param:opendaylight_service_host}
    keepalived_vip_password: ${_param:opnfv_main_password}
    keepalived_vip_interface: ${_param:single_nic}
  opendaylight:
    server:
      enabled: 'True'
      version: ${_param:opendaylight_version}
      repo: 'odl-team/${_param:opendaylight_version}'
      cluster_enabled: true
      logging:
        engine: syslog
  keepalived:
    cluster:
      vrrp_scripts:
        check_port:
          args:
            - ${_param:opendaylight_rest_port}
            - TCP
            - 4
          interval: 15
          rise: 3
          fall: 1
      instance:
        VIP:
          track_script: check_port
